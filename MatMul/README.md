# Лабораторная работа 1
## Юров Юрий группа 6132
Задача: реализовать алгоритм перемножения матриц
Язык: C++
Входные данные: 2 матрицы размером от 100х100 до 2000х2000 каждая.

Выходные данные: проверка корректности перемножения + время вычисления.

Реализация должна содержать 2 функции перемножения матриц: на CPU и на GPU с применением CUDA.

# Выполнение работы
## Проверка корректности перемножения
Для проверки корректности перемножения сравнивались две матрицы, одна из которых получалась на CPU, а вторая на GPU. Сравнение происходило поэлементно, с учётом погрешности.
Функция поэлементного сравнения приведена на рисунке.

![image](https://github.com/user-attachments/assets/bdf959bb-94d4-4365-8933-90568fa4b56e)

## Время вычисления
Время работы функций вычислялось с помощью библиотеки <chrono>.
Пример приведён на рисунке ниже.

![image](https://github.com/user-attachments/assets/c11b15b5-8acf-448c-9be5-48f899a36b59)

## Функция на CPU
На центральном процессоре была реализована последовательная функция для умножения матриц, которая заключалась в последовательном вычислении всех элементов матрицы.
В двойном цикле происходит прохождение по всем элементам матрицы и их вычисление по стандартному алгоритму.

![image](https://github.com/user-attachments/assets/c985243c-d398-489a-8a41-afe5c8d47142)

## Функция на GPU с применением CUDA
Функция сначала производит все приготовления перед вычислением матрицы на GPU, а именно: 
1. Выделяет память на графическом процессоре под матрицы.
2. Копирует две матрицы, произведение которых мы хотим найти.
3. Устанавливает размеры блоков и сетки.

Затем происходит запуск функции ядра, в которой на каждом потоке вычисляеся отдельный элемент матрицы также по стандартному алгоритму поэлементного уменожения строки первой матрицы на столбец второй.
Функция ядра:

![image](https://github.com/user-attachments/assets/6d55c57c-e7b1-487b-b12a-4e254d7743e7)

После подсчёта всех элементов на графическом процессоре происходит копирование полученной матрицы на CPU и очищение памяти на GPU.
# Результаты работы программы:
При исследовании полученной программы происходило перемножение различных матриц размерностями от 100х100 до 2000х2000 элементов, при этом замерялось время работы программы.
В итоге были получены следующие результаты времени работы функций и ускорение параллельной программы.

![image](https://github.com/user-attachments/assets/6e30c549-912c-4779-8625-7e15006b9018)

Из данных результатов можно сделать вывод, что при использовании матриц малых размерностей наблюдается замедление параллельной программы, поскольку время, затрачиваемое на выделение памяти на GPU и копирование элементов занимает больше времени, чем последовательный подсчёт матриц на CPU.
Однако, уже при использовании матриц 300х300 параллельная программа работает более чем в два раза быстрее, чем последовательная, а при дальнейшем увеличении размерностей позволяет добиться ускорения боллее, чем в 32 раза.
